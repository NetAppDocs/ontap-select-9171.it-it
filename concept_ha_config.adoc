---
sidebar: sidebar 
permalink: concept_ha_config.html 
keywords: ontap select, high availability configurations, two-node ha, multi-node ha, mc sds 
summary: Scopri le opzioni di elevata disponibilità per selezionare la configurazione HA migliore per il tuo ambiente. 
---
= ONTAP Select configurazioni ad alta disponibilità
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Scopri le opzioni di elevata disponibilità per selezionare la configurazione HA migliore per il tuo ambiente.

Sebbene i clienti stiano iniziando a spostare i carichi di lavoro applicativi da dispositivi di storage di classe enterprise a soluzioni software eseguite su hardware di base, le aspettative e le esigenze in termini di resilienza e tolleranza agli errori non sono cambiate. Una soluzione HA che offre un obiettivo di punto di ripristino (RPO) pari a zero protegge il cliente dalla perdita di dati dovuta a un guasto di qualsiasi componente dello stack infrastrutturale.

Gran parte del mercato SDS si basa sul concetto di storage shared-nothing, con la replica software che garantisce la resilienza dei dati archiviando più copie dei dati utente su diversi silos di storage. ONTAP Select si basa su questa premessa utilizzando le funzionalità di replica sincrona (RAID SyncMirror) fornite da ONTAP per archiviare una copia aggiuntiva dei dati utente all'interno del cluster. Ciò avviene nel contesto di una coppia HA. Ogni coppia HA archivia due copie dei dati utente: una sullo storage fornito dal nodo locale e una sullo storage fornito dal partner HA. All'interno di un cluster ONTAP Select , HA e replica sincrona sono collegate e le loro funzionalità non possono essere disaccoppiate o utilizzate in modo indipendente. Di conseguenza, la funzionalità di replica sincrona è disponibile solo nell'offerta multinodo.


NOTE: In un cluster ONTAP Select , la funzionalità di replica sincrona è una funzione dell'implementazione HA, non una sostituzione dei motori di replica asincroni SnapMirror o SnapVault . La replica sincrona non può essere utilizzata indipendentemente dall'HA.

Esistono due modelli di distribuzione HA ONTAP Select : i cluster multinodo (quattro, sei o otto nodi) e i cluster a due nodi. La caratteristica saliente di un cluster ONTAP Select a due nodi è l'utilizzo di un servizio di mediazione esterno per risolvere scenari split-brain. La VM di ONTAP Deploy funge da mediatore predefinito per tutte le coppie HA a due nodi che configura.

Le due architetture sono rappresentate nelle figure seguenti.

*Cluster ONTAP Select a due nodi con mediatore remoto e utilizzo di storage collegato localmente*

image:DDHA_01.jpg["Cluster ONTAP Select a due nodi con mediatore remoto e utilizzo di storage collegato localmente"]


NOTE: Il cluster ONTAP Select a due nodi è composto da una coppia HA e da un mediatore. All'interno della coppia HA, gli aggregati di dati su ciascun nodo del cluster vengono sottoposti a mirroring sincrono e, in caso di failover, non si verifica alcuna perdita di dati.

*Cluster ONTAP Select a quattro nodi che utilizza storage collegato localmente*image:DDHA_02.jpg["Cluster ONTAP Select a quattro nodi che utilizza storage collegato localmente"]

* Il cluster ONTAP Select a quattro nodi è composto da due coppie di HA. I cluster a sei e otto nodi sono composti rispettivamente da tre e quattro coppie di HA. All'interno di ciascuna coppia di HA, gli aggregati di dati su ciascun nodo del cluster vengono sottoposti a mirroring sincrono e, in caso di failover, non si verifica alcuna perdita di dati.
* Quando si utilizza l'archiviazione DAS, su un server fisico può essere presente una sola istanza ONTAP Select . ONTAP Select richiede l'accesso non condiviso al controller RAID locale del sistema ed è progettato per gestire i dischi collegati localmente, operazione impossibile senza connettività fisica all'archiviazione.




== HA a due nodi rispetto a HA multi-nodo

A differenza degli array FAS , i nodi ONTAP Select in una coppia HA comunicano esclusivamente sulla rete IP. Ciò significa che la rete IP rappresenta un singolo punto di errore (SPOF) e la protezione da partizioni di rete e scenari split-brain diventa un aspetto importante della progettazione. Il cluster multinodo può supportare guasti a nodo singolo perché il quorum del cluster può essere stabilito dai tre o più nodi superstiti. Il cluster a due nodi si affida al servizio di mediazione ospitato dalla VM ONTAP Deploy per ottenere lo stesso risultato.

Il traffico di rete heartbeat tra i nodi ONTAP Select e il servizio mediatore ONTAP Deploy è minimo e resiliente, in modo che la VM ONTAP Deploy possa essere ospitata in un data center diverso dal cluster a due nodi ONTAP Select .


NOTE: La VM ONTAP Deploy diventa parte integrante di un cluster a due nodi quando funge da mediatore per quel cluster. Se il servizio mediatore non è disponibile, il cluster a due nodi continua a gestire i dati, ma le funzionalità di failover dello storage del cluster ONTAP Select sono disabilitate. Pertanto, il servizio mediatore ONTAP Deploy deve mantenere una comunicazione costante con ciascun nodo ONTAP Select nella coppia HA. Per consentire il corretto funzionamento del quorum del cluster, sono necessari una larghezza di banda minima di 5 Mbps e una latenza massima del tempo di round-trip (RTT) di 125 ms.

Se la VM ONTAP Deploy che funge da mediatore è temporaneamente o potenzialmente permanentemente non disponibile, è possibile utilizzare una VM ONTAP Deploy secondaria per ripristinare il quorum del cluster a due nodi. Ciò si traduce in una configurazione in cui la nuova VM ONTAP Deploy non è in grado di gestire i nodi ONTAP Select , ma partecipa correttamente all'algoritmo del quorum del cluster. La comunicazione tra i nodi ONTAP Select e la VM ONTAP Deploy avviene tramite il protocollo iSCSI su IPv4. L'indirizzo IP di gestione del nodo ONTAP Select è l'iniziatore e l'indirizzo IP della VM ONTAP Deploy è la destinazione. Pertanto, non è possibile supportare indirizzi IPv6 per gli indirizzi IP di gestione dei nodi durante la creazione di un cluster a due nodi. I dischi delle caselle di posta ospitate da ONTAP Deploy vengono creati automaticamente e mascherati con gli indirizzi IP di gestione del nodo ONTAP Select appropriati al momento della creazione del cluster a due nodi. L'intera configurazione viene eseguita automaticamente durante l'installazione e non sono richieste ulteriori azioni amministrative. L'istanza ONTAP Deploy che crea il cluster è il mediatore predefinito per quel cluster.

È necessario un intervento amministrativo se è necessario modificare la posizione originale del mediatore. È possibile ripristinare il quorum di un cluster anche se la VM ONTAP Deploy originale è andata persa. Tuttavia, NetApp consiglia di eseguire il backup del database ONTAP Deploy dopo ogni istanza di un cluster a due nodi.



== HA a due nodi rispetto a HA esteso a due nodi (MetroCluster SDS)

È possibile estendere un cluster HA attivo/attivo a due nodi su distanze maggiori e potenzialmente collocare ciascun nodo in un data center diverso. L'unica differenza tra un cluster a due nodi e un cluster esteso a due nodi (noto anche come MetroCluster SDS) è la distanza di connettività di rete tra i nodi.

Il cluster a due nodi è definito come un cluster in cui entrambi i nodi si trovano nello stesso data center entro una distanza massima di 300 m. In generale, entrambi i nodi hanno uplink allo stesso switch di rete o allo stesso set di switch di rete ISL (Interswitch Link).

Un MetroCluster SDS a due nodi è definito come un cluster in cui i nodi sono fisicamente separati (stanze diverse, edifici diversi e data center diversi) da oltre 300 m. Inoltre, le connessioni uplink di ciascun nodo sono collegate a switch di rete separati. Il MetroCluster SDS non richiede hardware dedicato. Tuttavia, l'ambiente deve rispettare i requisiti di latenza (un massimo di 5 ms per RTT e 5 ms per jitter, per un totale di 10 ms) e distanza fisica (un massimo di 10 km).

MetroCluster SDS è una funzionalità premium e richiede una licenza Premium o una licenza Premium XL. La licenza Premium supporta la creazione di VM di piccole e medie dimensioni, nonché di supporti HDD e SSD. La licenza Premium XL supporta anche la creazione di unità NVMe.


NOTE: MetroCluster SDS è supportato sia con storage locale collegato (DAS) che con storage condiviso (vNAS). Si noti che le configurazioni vNAS presentano solitamente una latenza innata più elevata a causa della rete tra la VM ONTAP Select e lo storage condiviso. Le configurazioni MetroCluster SDS devono fornire una latenza massima di 10 ms tra i nodi, inclusa la latenza dello storage condiviso. In altre parole, misurare solo la latenza tra le VM Select non è adeguato, poiché la latenza dello storage condiviso non è trascurabile per queste configurazioni.
